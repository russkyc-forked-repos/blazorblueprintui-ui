@page "/components/toast"
@inject ToastService ToastService

<PageTitle>Toast Component - Blazor Blueprint</PageTitle>

<div class="space-y-8 max-w-4xl">
    <div>
        <div class="space-y-3">
            <h1 class="text-4xl font-bold tracking-tight">Toast Component</h1>
            <p class="text-xl text-muted-foreground">
                A succinct message that is displayed temporarily to notify users.
            </p>
        </div>
    </div>

    <!-- Setup Instructions -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Setup</h2>
            <p class="text-sm text-muted-foreground">
                Add the ToastProvider to your root layout. The ToastService is automatically registered when you call <code class="text-xs bg-muted px-1 py-0.5 rounded">AddBlazorBlueprintComponents()</code>.
            </p>
        </div>
        <div class="border rounded-lg p-6 space-y-4 bg-muted/50">
            <p class="text-sm font-medium">Add ToastProvider to your layout:</p>
            <pre class="text-sm bg-muted p-3 rounded overflow-x-auto"><code>&lt;BbToastProvider Position="ToastPosition.BottomRight" PauseOnHover="true" /&gt;</code></pre>
        </div>
    </div>

    <!-- Basic Examples -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Basic Examples</h2>
            <p class="text-sm text-muted-foreground">
                Click the buttons to trigger different toast messages.
            </p>
        </div>
        <div class="flex flex-wrap gap-4">
            <BbButton OnClick="@ShowDefaultToast">
                Show Toast
            </BbButton>
            <BbButton Variant="ButtonVariant.Outline" OnClick="@ShowTitleToast">
                With Title
            </BbButton>
            <BbButton Variant="ButtonVariant.Destructive" OnClick="@ShowErrorToast">
                Error Toast
            </BbButton>
        </div>

        <CodeBlock Source="Components/Toast/basic.txt" />
    </div>

    <!-- Toast Variants -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Variants</h2>
            <p class="text-sm text-muted-foreground">
                Toasts come in 5 variants, each with automatic icons for semantic variants. Use the factory methods on <code class="text-xs bg-muted px-1 py-0.5 rounded">ToastService</code> for convenience.
            </p>
        </div>
        <div class="flex flex-wrap gap-4">
            <BbButton Variant="ButtonVariant.Outline" OnClick="@(() => ToastService.Show("A general notification.", "Default"))">
                Default
            </BbButton>
            <BbButton Variant="ButtonVariant.Secondary" OnClick="@(() => ToastService.Success("Your changes have been saved.", "Success"))">
                Success
            </BbButton>
            <BbButton Variant="ButtonVariant.Secondary" OnClick="@(() => ToastService.Info("A new version is available.", "Info"))">
                Info
            </BbButton>
            <BbButton Variant="ButtonVariant.Secondary" OnClick="@(() => ToastService.Warning("Your session is about to expire.", "Warning"))">
                Warning
            </BbButton>
            <BbButton Variant="ButtonVariant.Destructive" OnClick="@(() => ToastService.Error("Something went wrong.", "Error"))">
                Error
            </BbButton>
        </div>

        <CodeBlock Source="Components/Toast/variants.txt" />
    </div>

    <!-- Compact Size -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Compact Size</h2>
            <p class="text-sm text-muted-foreground">
                Use <code class="text-xs bg-muted px-1 py-0.5 rounded">ToastSize.Compact</code> for smaller toasts with reduced padding and font sizes. Ideal for dialog-embedded or dense layouts.
            </p>
        </div>
        <div class="flex flex-wrap gap-4">
            <BbButton Variant="ButtonVariant.Outline" OnClick="@ShowCompactToast">
                Compact Toast
            </BbButton>
            <BbButton Variant="ButtonVariant.Outline" OnClick="@ShowCompactSuccessToast">
                Compact Success
            </BbButton>
            <BbButton Variant="ButtonVariant.Outline" OnClick="@ShowCompactWithAction">
                Compact with Action
            </BbButton>
        </div>

        <CodeBlock Source="Components/Toast/compact.txt" />
    </div>

    <!-- Auto Icons -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Auto Icons</h2>
            <p class="text-sm text-muted-foreground">
                Semantic variants (Success, Info, Warning, Destructive) automatically display icons. Set <code class="text-xs bg-muted px-1 py-0.5 rounded">ShowIcon = false</code> to hide them.
            </p>
        </div>
        <div class="flex flex-wrap gap-4">
            <BbButton Variant="ButtonVariant.Secondary" OnClick="@(() => ToastService.Success("With auto icon.", "Success"))">
                With Icon
            </BbButton>
            <BbButton Variant="ButtonVariant.Outline" OnClick="@ShowNoIconToast">
                Without Icon
            </BbButton>
        </div>

        <CodeBlock Source="Components/Toast/auto-icons.txt" />
    </div>

    <!-- With Action -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">With Action</h2>
            <p class="text-sm text-muted-foreground">
                Toasts can include an action button.
            </p>
        </div>
        <BbButton OnClick="@ShowActionToast">
            Show with Action
        </BbButton>

        <CodeBlock Source="Components/Toast/with-action.txt" />
    </div>

    <!-- Position Options -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Position</h2>
            <p class="text-sm text-muted-foreground">
                Configure where toasts appear on the screen via the ToastProvider, or override per-toast.
            </p>
        </div>
        <div class="border rounded-lg p-6 space-y-4 bg-muted/50">
            <p class="text-sm font-medium">Provider position (all toasts):</p>
            <div class="grid grid-cols-3 gap-2 text-center text-sm">
                @foreach (var pos in positions)
                {
                    <BbButton Variant="@(selectedPosition == pos.Value ? ButtonVariant.Default : ButtonVariant.Outline)"
                            OnClick="@(() => ShowPositionToast(pos.Value))">
                        @pos.Label
                    </BbButton>
                }
            </div>
            <p class="text-sm font-medium mt-4">Per-toast position override:</p>
            <BbButton Variant="ButtonVariant.Outline" OnClick="@ShowPerToastPosition">
                Show in Top-Left
            </BbButton>
            <pre class="text-sm bg-muted p-3 rounded overflow-x-auto"><code>&lt;BbToastProvider Position="ToastPosition.@(selectedPosition)" /&gt;</code></pre>
        </div>

        <CodeBlock Source="Components/Toast/position.txt" />
    </div>

    <!-- Custom Duration -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Custom Duration</h2>
            <p class="text-sm text-muted-foreground">
                Control how long the toast is displayed. Hover over a toast to pause its auto-dismiss timer (when <code class="text-xs bg-muted px-1 py-0.5 rounded">PauseOnHover</code> is enabled).
            </p>
        </div>
        <div class="flex flex-wrap gap-4">
            <BbButton Variant="ButtonVariant.Outline" OnClick="@(() => ToastService.Show("This disappears quickly!", duration: 2000))">
                2 seconds
            </BbButton>
            <BbButton Variant="ButtonVariant.Outline" OnClick="@(() => ToastService.Show("This stays longer.", duration: 10000))">
                10 seconds
            </BbButton>
            <BbButton Variant="ButtonVariant.Outline" OnClick="@ShowPersistentToast">
                Persistent (no auto-dismiss)
            </BbButton>
        </div>

        <CodeBlock Source="Components/Toast/custom-duration.txt" />
    </div>

    <!-- Programmatic Control -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Programmatic Control</h2>
            <p class="text-sm text-muted-foreground">
                Dismiss toasts programmatically.
            </p>
        </div>
        <div class="flex flex-wrap gap-4">
            <BbButton Variant="ButtonVariant.Outline" OnClick="@ShowMultipleToasts">
                Show 3 Toasts
            </BbButton>
            <BbButton Variant="ButtonVariant.Secondary" OnClick="@(() => ToastService.DismissAll())">
                Dismiss All
            </BbButton>
        </div>

        <CodeBlock Source="Components/Toast/programmatic-control.txt" />
    </div>

    <!-- Custom Styling -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Custom Styling</h2>
            <p class="text-sm text-muted-foreground">
                Use the <code class="text-xs bg-muted px-1 py-0.5 rounded">Class</code> property on <code class="text-xs bg-muted px-1 py-0.5 rounded">ToastData</code> to create custom-styled toasts. TailwindMerge ensures your classes override the built-in variant styles.
            </p>
        </div>
        <div class="flex flex-wrap gap-4">
            <BbButton Variant="ButtonVariant.Outline" OnClick="@ShowBrandStyledToast">
                Brand Style
            </BbButton>
        </div>

        <CodeBlock Source="Components/Toast/custom-styling.txt" />
    </div>

    <!-- API Reference -->
    <section class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">API Reference</h2>
            <p class="text-muted-foreground">Component properties and parameters.</p>
        </div>

        <div class="space-y-4">
            <ApiReference ComponentName="ToastService Methods">
                <ApiParameter Name="Show(ToastData toast)" Type="void">
                    Show a toast with full control
                </ApiParameter>
                <ApiParameter Name="Show(description, title?, variant?, duration?)" Type="void">
                    Quick toast
                </ApiParameter>
                <ApiParameter Name="Success(description, title?)" Type="void">
                    Show success toast (green accent, circle-check icon)
                </ApiParameter>
                <ApiParameter Name="Info(description, title?)" Type="void">
                    Show info toast (blue accent, info icon)
                </ApiParameter>
                <ApiParameter Name="Warning(description, title?)" Type="void">
                    Show warning toast (amber accent, triangle-alert icon)
                </ApiParameter>
                <ApiParameter Name="Error(description, title?)" Type="void">
                    Show error toast (red accent, circle-x icon)
                </ApiParameter>
                <ApiParameter Name="Dismiss(id)" Type="void">
                    Dismiss specific toast
                </ApiParameter>
                <ApiParameter Name="DismissAll()" Type="void">
                    Dismiss all toasts
                </ApiParameter>
            </ApiReference>

            <ApiReference ComponentName="BbToastProvider">
                <ApiParameter Name="Position" Type="ToastPosition" Default="BottomRight">
                    Where toasts appear (TopRight, TopLeft, TopCenter, BottomRight, BottomLeft, BottomCenter)
                </ApiParameter>
                <ApiParameter Name="MaxToasts" Type="int" Default="5">
                    Maximum visible toasts.
                </ApiParameter>
                <ApiParameter Name="PauseOnHover" Type="bool" Default="true">
                    Pause auto-dismiss when the mouse hovers over a toast.
                </ApiParameter>
            </ApiReference>

            <ApiReference ComponentName="ToastData">
                <ApiParameter Name="Title" Type="string?">
                    Optional title text
                </ApiParameter>
                <ApiParameter Name="Description" Type="string">
                    Main message content
                </ApiParameter>
                <ApiParameter Name="Variant" Type="ToastVariant" Default="Default">
                    Default, Success, Info, Warning, or Destructive
                </ApiParameter>
                <ApiParameter Name="Size" Type="ToastSize" Default="Default">
                    Default or Compact
                </ApiParameter>
                <ApiParameter Name="Position" Type="ToastPosition?">
                    Per-toast position override. When set, renders in a separate container.
                </ApiParameter>
                <ApiParameter Name="ShowIcon" Type="bool" Default="true">
                    Show variant-specific icon (Default variant has no icon).
                </ApiParameter>
                <ApiParameter Name="Duration" Type="int" Default="5000">
                    Auto-dismiss time in ms (0 for no auto-dismiss).
                </ApiParameter>
                <ApiParameter Name="ShowClose" Type="bool" Default="true">
                    Show close button.
                </ApiParameter>
                <ApiParameter Name="ActionText" Type="string?">
                    Optional action button text
                </ApiParameter>
                <ApiParameter Name="OnAction" Type="Action?">
                    Action button callback
                </ApiParameter>
            </ApiReference>
        </div>
    </section>
</div>

@code {
    private ToastPosition selectedPosition = ToastPosition.BottomRight;

    private readonly record struct PositionOption(string Label, ToastPosition Value);

    private static readonly PositionOption[] positions =
    [
        new("TopLeft", ToastPosition.TopLeft),
        new("TopCenter", ToastPosition.TopCenter),
        new("TopRight", ToastPosition.TopRight),
        new("BottomLeft", ToastPosition.BottomLeft),
        new("BottomCenter", ToastPosition.BottomCenter),
        new("BottomRight (default)", ToastPosition.BottomRight),
    ];

    private void ShowPositionToast(ToastPosition position)
    {
        selectedPosition = position;
        ToastService.SetPosition(position);
        ToastService.Show($"Position set to {position}");
    }

    private void ShowDefaultToast()
    {
        ToastService.Show("Your message has been sent.");
    }

    private void ShowTitleToast()
    {
        ToastService.Show("Friday, February 10, 2023 at 5:57 PM", "Scheduled: Catch up");
    }

    private void ShowErrorToast()
    {
        ToastService.Error("There was a problem with your request.", "Uh oh! Something went wrong.");
    }

    private void ShowActionToast()
    {
        ToastService.Show(new ToastData
        {
            Title = "Undo action",
            Description = "Your post has been deleted.",
            ActionText = "Undo",
            OnAction = () => ToastService.Success("Post restored!")
        });
    }

    private void ShowPersistentToast()
    {
        ToastService.Show(new ToastData
        {
            Title = "Persistent Toast",
            Description = "This toast won't auto-dismiss. Click X to close.",
            Duration = 0
        });
    }

    private void ShowMultipleToasts()
    {
        ToastService.Show("First notification");
        ToastService.Info("Second notification is informational", "Info");
        ToastService.Error("Third notification is an error");
    }

    private void ShowCompactToast()
    {
        ToastService.Show(new ToastData
        {
            Title = "Compact",
            Description = "A smaller toast with reduced padding.",
            Size = ToastSize.Compact
        });
    }

    private void ShowCompactSuccessToast()
    {
        ToastService.Show(new ToastData
        {
            Title = "Saved",
            Description = "Your changes have been saved.",
            Variant = ToastVariant.Success,
            Size = ToastSize.Compact
        });
    }

    private void ShowCompactWithAction()
    {
        ToastService.Show(new ToastData
        {
            Title = "Deleted",
            Description = "Item removed.",
            Variant = ToastVariant.Destructive,
            Size = ToastSize.Compact,
            ActionText = "Undo",
            OnAction = () => ToastService.Success("Item restored!")
        });
    }

    private void ShowNoIconToast()
    {
        ToastService.Show(new ToastData
        {
            Title = "Success",
            Description = "Saved without the icon.",
            Variant = ToastVariant.Success,
            ShowIcon = false
        });
    }

    private void ShowPerToastPosition()
    {
        ToastService.Show(new ToastData
        {
            Title = "Top-Left Toast",
            Description = "This toast appears in the top-left corner.",
            Variant = ToastVariant.Info,
            Position = ToastPosition.TopLeft
        });
    }

    private void ShowBrandStyledToast()
    {
        ToastService.Show(new ToastData
        {
            Title = "Brand Notification",
            Description = "A custom-styled toast matching your brand colors.",
            Class = "border-purple-500/30 bg-gradient-to-r from-purple-600 to-pink-600 text-white"
        });
    }
}
