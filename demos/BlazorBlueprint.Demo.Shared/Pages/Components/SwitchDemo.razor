@page "/components/switch"
@using System.ComponentModel.DataAnnotations

<PageTitle>Switch Component - Blazor Blueprint</PageTitle>

<div class="space-y-8 max-w-4xl">
    <div>
        <div class="space-y-3">
        <h1 class="text-4xl font-bold tracking-tight">Switch Component</h1>
        <p class="text-xl text-muted-foreground">
            A toggle control that allows users to switch between checked and unchecked states.
        </p>
        </div>
    </div>

    <div class="space-y-6">
    </div>

    <!-- Basic Usage -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Basic Usage</h2>
            <p class="text-sm text-muted-foreground">
                Simple switch with label using two-way binding.
            </p>
        </div>
        <div class="space-y-3">
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="basicChecked" Id="basic-switch" />
                <label for="basic-switch" class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70">
                    Airplane Mode
                </label>
            </div>
            <p class="text-sm text-muted-foreground">
                Current state: @(basicChecked ? "On ✓" : "Off")
            </p>
        </div>
        <CodeBlock Source="Components/Switch/basic.txt" />
    </div>

    <!-- Size Variants -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Size Variants</h2>
            <p class="text-sm text-muted-foreground">
                Switches come in three sizes: Small, Medium (default), and Large.
            </p>
        </div>
        <div class="space-y-3">
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="smallChecked" Size="SwitchSize.Small" Id="small-switch" />
                <label for="small-switch" class="text-sm font-medium leading-none">
                    Small switch
                </label>
            </div>
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="mediumChecked" Size="SwitchSize.Medium" Id="medium-switch" />
                <label for="medium-switch" class="text-sm font-medium leading-none">
                    Medium switch (default)
                </label>
            </div>
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="largeChecked" Size="SwitchSize.Large" Id="large-switch" />
                <label for="large-switch" class="text-sm font-medium leading-none">
                    Large switch
                </label>
            </div>
        </div>
        <CodeBlock Source="Components/Switch/sizes.txt" />
    </div>

    <!-- Settings Example -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Settings Panel</h2>
            <p class="text-sm text-muted-foreground">
                Group of switches for application settings.
            </p>
        </div>
        <div class="space-y-3">
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="notifications" Id="notifications" />
                <label for="notifications" class="text-sm font-medium leading-none">
                    Enable notifications
                </label>
            </div>
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="autoSave" Id="auto-save" />
                <label for="auto-save" class="text-sm font-medium leading-none">
                    Auto-save changes
                </label>
            </div>
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="analytics" Id="analytics" />
                <label for="analytics" class="text-sm font-medium leading-none">
                    Send usage analytics
                </label>
            </div>
            <p class="text-sm text-muted-foreground">
                Active settings: @string.Join(", ", GetActiveSettings())
            </p>
        </div>
        <CodeBlock Source="Components/Switch/settings-panel.txt" />
    </div>

    <!-- Disabled State -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Disabled State</h2>
            <p class="text-sm text-muted-foreground">
                Switches that cannot be interacted with.
            </p>
        </div>
        <div class="space-y-3">
            <div class="flex items-center space-x-2">
                <BbSwitch Disabled="true" Checked="false" Id="disabled-off" />
                <label for="disabled-off" class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70">
                    Disabled (off)
                </label>
            </div>
            <div class="flex items-center space-x-2">
                <BbSwitch Disabled="true" Checked="true" Id="disabled-on" />
                <label for="disabled-on" class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70">
                    Disabled (on)
                </label>
            </div>
        </div>
        <CodeBlock Source="Components/Switch/disabled.txt" />
    </div>

    <!-- Form Validation -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Form Validation</h2>
            <p class="text-sm text-muted-foreground">
                Switch integrated with Blazor's EditForm and validation.
            </p>
        </div>
        <EditForm Model="formModel" OnValidSubmit="HandleValidSubmit" class="space-y-4">
            <DataAnnotationsValidator />

            <div class="space-y-3">
                <div class="flex items-center space-x-2">
                    <BbSwitch @bind-Checked="formModel.AcceptTerms" Id="terms" />
                    <label for="terms" class="text-sm font-medium leading-none">
                        I accept the terms and conditions
                    </label>
                </div>
                <ValidationMessage For="@(() => formModel.AcceptTerms)" class="text-sm text-destructive" />
            </div>

            <div class="space-y-3">
                <div class="flex items-center space-x-2">
                    <BbSwitch @bind-Checked="formModel.EnableMarketing" Id="marketing" />
                    <label for="marketing" class="text-sm font-medium leading-none">
                        Enable marketing emails (optional)
                    </label>
                </div>
            </div>

            <div class="flex gap-4">
                <BbButton Type="ButtonType.Submit" Variant="ButtonVariant.Default">Submit</BbButton>
                <BbButton Type="ButtonType.Button" Variant="ButtonVariant.Outline" OnClick="ResetForm">Reset</BbButton>
            </div>

            @if (!string.IsNullOrEmpty(formMessage))
            {
                <div class="p-4 bg-card rounded-lg border">
                    <p class="text-sm">@formMessage</p>
                </div>
            }
        </EditForm>
        <CodeBlock Source="Components/Switch/form-validation.txt" />
    </div>

    <!-- Interactive Example -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Interactive</h2>
            <p class="text-sm text-muted-foreground">
                Switch with custom change handler.
            </p>
        </div>
        <div class="space-y-3">
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="interactiveChecked" Id="interactive" />
                <label for="interactive" class="text-sm font-medium leading-none">
                    Enable dark mode
                </label>
            </div>
            @if (interactiveChecked)
            {
                <div class="p-4 bg-primary/10 rounded-lg border border-primary">
                    <p class="text-sm">✓ Dark mode enabled! Last toggled at @lastToggleTime</p>
                </div>
            }
            else
            {
                <div class="p-4 bg-muted rounded-lg">
                    <p class="text-sm text-muted-foreground">Dark mode disabled</p>
                </div>
            }
        </div>
        <CodeBlock Source="Components/Switch/interactive.txt" />
    </div>

    <!-- Card Layout -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Settings Cards</h2>
            <p class="text-sm text-muted-foreground">
                Switches within card containers for a polished settings interface.
            </p>
        </div>
        <div class="space-y-3">
            <div class="flex items-center justify-between rounded-lg border p-4">
                <div class="space-y-0.5">
                    <div class="text-sm font-medium leading-none">
                        Email Notifications
                    </div>
                    <div class="text-sm text-muted-foreground">
                        Receive email about your account activity
                    </div>
                </div>
                <BbSwitch @bind-Checked="cardNotifications" Id="card-notifications" />
            </div>
            <div class="flex items-center justify-between rounded-lg border p-4">
                <div class="space-y-0.5">
                    <div class="text-sm font-medium leading-none">
                        Marketing Emails
                    </div>
                    <div class="text-sm text-muted-foreground">
                        Receive emails about new products and features
                    </div>
                </div>
                <BbSwitch @bind-Checked="cardMarketing" Id="card-marketing" />
            </div>
            <div class="flex items-center justify-between rounded-lg border p-4">
                <div class="space-y-0.5">
                    <div class="text-sm font-medium leading-none">
                        Social Notifications
                    </div>
                    <div class="text-sm text-muted-foreground">
                        Receive notifications from social interactions
                    </div>
                </div>
                <BbSwitch @bind-Checked="cardSocial" Id="card-social" />
            </div>
        </div>
        <CodeBlock Source="Components/Switch/settings-cards.txt" />
    </div>

    <!-- Icon Thumb -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Icon Thumb</h2>
            <p class="text-sm text-muted-foreground">
                Render custom content inside the thumb using <code class="text-xs bg-muted px-1 py-0.5 rounded">ThumbContent</code>.
                The context parameter provides the checked state for conditional rendering.
            </p>
        </div>
        <div class="space-y-3">
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="iconTheme" Size="SwitchSize.Large" Id="icon-theme"
                        ThumbCheckedClass="bg-slate-800 text-white"
                        ThumbUncheckedClass="bg-amber-400 text-amber-900">
                    <ThumbContent>
                        @if (context)
                        {
                            <LucideIcon Name="moon" Size="14" />
                        }
                        else
                        {
                            <LucideIcon Name="sun" Size="14" />
                        }
                    </ThumbContent>
                </BbSwitch>
                <label for="icon-theme" class="text-sm font-medium leading-none">
                    @(iconTheme ? "Dark mode" : "Light mode")
                </label>
            </div>
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="iconSound" Size="SwitchSize.Large" Id="icon-sound"
                        ThumbCheckedClass="bg-primary text-primary-foreground"
                        ThumbUncheckedClass="text-muted-foreground">
                    <ThumbContent>
                        @if (context)
                        {
                            <LucideIcon Name="volume-2" Size="14" />
                        }
                        else
                        {
                            <LucideIcon Name="volume-x" Size="14" />
                        }
                    </ThumbContent>
                </BbSwitch>
                <label for="icon-sound" class="text-sm font-medium leading-none">
                    @(iconSound ? "Sound on" : "Sound off")
                </label>
            </div>
        </div>
        <CodeBlock Source="Components/Switch/icon-thumb.txt" />
    </div>

    <!-- Custom Styling -->
    <div class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">Custom Styling</h2>
            <p class="text-sm text-muted-foreground">
                Customize the track and thumb independently. Use <code class="text-xs bg-muted px-1 py-0.5 rounded">ThumbCheckedClass</code>
                and <code class="text-xs bg-muted px-1 py-0.5 rounded">ThumbUncheckedClass</code> for state-dependent thumb styles.
            </p>
        </div>
        <div class="space-y-3">
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="styled1" Class="shadow-lg" Id="styled1" />
                <label for="styled1" class="text-sm font-medium leading-none">
                    Track with shadow
                </label>
            </div>
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="styled2" ThumbClass="bg-primary" Id="styled2" />
                <label for="styled2" class="text-sm font-medium leading-none">
                    Colored thumb (always)
                </label>
            </div>
            <div class="flex items-center space-x-2">
                <BbSwitch @bind-Checked="styled3"
                        ThumbCheckedClass="bg-green-500"
                        ThumbUncheckedClass="bg-red-500"
                        Id="styled3" />
                <label for="styled3" class="text-sm font-medium leading-none">
                    State-dependent thumb color
                </label>
            </div>
        </div>
        <CodeBlock Source="Components/Switch/custom-styling.txt" />
    </div>

    <!-- Accessibility Notes -->
    <AccessibilityList>
        <AriaAttributes>
            <AccessibilityItem>
                Disabled switches are not focusable (tabindex="-1")
            </AccessibilityItem>
            <AccessibilityItem>
                ARIA attributes set correctly (<code class="text-xs bg-muted px-1 py-0.5 rounded">role="switch"</code>, <code class="text-xs bg-muted px-1 py-0.5 rounded">aria-checked</code>, <code class="text-xs bg-muted px-1 py-0.5 rounded">aria-disabled</code>)
            </AccessibilityItem>
            <AccessibilityItem>
                Focus ring appears on keyboard focus (focus-visible:ring-2)
            </AccessibilityItem>
            <AccessibilityItem>
                Color contrast designed for readability
            </AccessibilityItem>
            <AccessibilityItem>
                Semantic label association using htmlFor attribute
            </AccessibilityItem>
            <AccessibilityItem>
                Uses role="switch" and aria-checked for assistive technology context
            </AccessibilityItem>
        </AriaAttributes>
        <KeyboardNavigation>
            <KeyboardShortcutItem Description="Focus switches in sequence">
                <BbKbd>Tab</BbKbd>
            </KeyboardShortcutItem>
            <KeyboardShortcutItem Description="Toggle focused switch">
                <BbKbd>Space</BbKbd> or <BbKbd>Enter</BbKbd>
            </KeyboardShortcutItem>
        </KeyboardNavigation>
    </AccessibilityList>

    <!-- API Reference -->
    <section class="space-y-4">
        <div class="space-y-2">
            <h2 class="text-2xl font-semibold">API Reference</h2>
            <p class="text-muted-foreground">Component properties and parameters.</p>
        </div>

        <div class="space-y-4">
            <ApiReference ComponentName="Switch">
                <ApiParameter Name="Checked" Type="bool" Default="false">
                    Whether the switch is checked (on). Supports two-way binding with <code>@@bind-Checked</code>.
                </ApiParameter>
                <ApiParameter Name="Disabled" Type="bool" Default="false">
                    Whether the switch is disabled. Prevents interaction and reduces opacity.
                </ApiParameter>
                <ApiParameter Name="Size" Type="SwitchSize" Default="Medium">
                    Size variant. Options: Small, Medium, Large.
                </ApiParameter>
                <ApiParameter Name="Id" Type="string?" Default="null">
                    HTML id attribute. Used for associating with a label element.
                </ApiParameter>
                <ApiParameter Name="AriaLabel" Type="string?" Default="null">
                    Accessible name for the switch when no visible label is present.
                </ApiParameter>
                <ApiParameter Name="AriaDescribedBy" Type="string?" Default="null">
                    ID of the element containing help text for screen readers.
                </ApiParameter>
                <ApiParameter Name="Class" Type="string?" Default="null">
                    Additional CSS classes for the switch track element.
                </ApiParameter>
                <ApiParameter Name="ThumbClass" Type="string?" Default="null">
                    Additional CSS classes for the switch thumb element.
                </ApiParameter>
                <ApiParameter Name="ThumbCheckedClass" Type="string?" Default="null">
                    Additional CSS classes applied to the thumb when checked.
                </ApiParameter>
                <ApiParameter Name="ThumbUncheckedClass" Type="string?" Default="null">
                    Additional CSS classes applied to the thumb when unchecked.
                </ApiParameter>
                <ApiParameter Name="ThumbContent" Type="RenderFragment&lt;bool&gt;?" Default="null">
                    Custom content to render inside the thumb. The context parameter is the checked state.
                </ApiParameter>
            </ApiReference>
        </div>
    </section>
</div>

@code {
    // Basic switch
    private bool basicChecked = false;

    // Size variants
    private bool smallChecked = false;
    private bool mediumChecked = true;
    private bool largeChecked = false;

    // Settings panel
    private bool notifications = true;
    private bool autoSave = false;
    private bool analytics = true;

    // Interactive
    private bool _interactiveChecked = false;
    private bool interactiveChecked
    {
        get => _interactiveChecked;
        set
        {
            _interactiveChecked = value;
            if (value)
            {
                lastToggleTime = DateTime.Now.ToString("HH:mm:ss");
            }
        }
    }
    private string lastToggleTime = "";

    // Card layout
    private bool cardNotifications = true;
    private bool cardMarketing = false;
    private bool cardSocial = true;

    // Icon thumb
    private bool iconTheme = false;
    private bool iconSound = true;

    // Custom styling
    private bool styled1 = false;
    private bool styled2 = false;
    private bool styled3 = false;

    // Form validation
    private FormModel formModel = new();
    private string formMessage = "";

    private List<string> GetActiveSettings()
    {
        var active = new List<string>();
        if (notifications) active.Add("Notifications");
        if (autoSave) active.Add("Auto-save");
        if (analytics) active.Add("Analytics");
        return active.Count > 0 ? active : new List<string> { "None" };
    }

    private void HandleValidSubmit()
    {
        formMessage = $"Form submitted successfully at {DateTime.Now:HH:mm:ss}. " +
                     $"Terms accepted: {formModel.AcceptTerms}, " +
                     $"Marketing: {formModel.EnableMarketing}";
    }

    private void ResetForm()
    {
        formModel = new FormModel();
        formMessage = "";
    }

    public class FormModel
    {
        [Required(ErrorMessage = "You must accept the terms and conditions")]
        [Range(typeof(bool), "true", "true", ErrorMessage = "You must accept the terms and conditions")]
        public bool AcceptTerms { get; set; }

        public bool EnableMarketing { get; set; }
    }
}
