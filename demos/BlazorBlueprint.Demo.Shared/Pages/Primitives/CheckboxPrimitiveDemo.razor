@page "/primitives/checkbox"
<PageTitle>Checkbox Primitive - Blazor Blueprint</PageTitle>

<div class="space-y-8 max-w-4xl">
    <div>
        <div class="space-y-3">
            <h1 class="text-4xl font-bold tracking-tight">Checkbox Primitive</h1>
            <p class="text-xl text-muted-foreground">
                Unstyled, accessible primitive component for building custom checkboxes.
            </p>
        </div>
    </div>

    <div class="space-y-6">
        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Basic Headless Primitive</h2>
                <p class="text-muted-foreground">
                    The primitive provides behavior and accessibility without styling.
                </p>
            </div>

            <div class="rounded-lg border bg-card p-6 max-w-md">
                <div class="flex items-center gap-3">
                    <BlazorBlueprint.Primitives.Checkbox.BbCheckbox @bind-Checked="basicChecked" Id="basic" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center">
                        <BlazorBlueprint.Primitives.Checkbox.BbCheckboxIndicator />
                    </BlazorBlueprint.Primitives.Checkbox.BbCheckbox>
                    <label for="basic">Unstyled primitive checkbox</label>
                </div>
                <p class="text-sm text-muted-foreground mt-2">
                    State: <strong>@(basicChecked ? "Checked" : "Unchecked")</strong>
                </p>
            </div>

            <CodeBlock Source="Primitives/Checkbox/basic.txt" />
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Controlled State</h2>
                <p class="text-muted-foreground">
                    Control the primitive state externally.
                </p>
            </div>

            <div class="space-y-4">
                <div class="flex gap-2">
                    <button @onclick="@(() => controlledChecked = true)"
                            class="px-3 py-2 border rounded text-sm">
                        Check
                    </button>
                    <button @onclick="@(() => controlledChecked = false)"
                            class="px-3 py-2 border rounded text-sm">
                        Uncheck
                    </button>
                </div>

                <div class="rounded-lg border bg-card p-6 max-w-md">
                    <div class="flex items-center gap-3">
                        <BlazorBlueprint.Primitives.Checkbox.BbCheckbox @bind-Checked="controlledChecked" Id="controlled" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center">
                            <BlazorBlueprint.Primitives.Checkbox.BbCheckboxIndicator />
                        </BlazorBlueprint.Primitives.Checkbox.BbCheckbox>
                        <label for="controlled">
                            Controlled Checkbox (State: @(controlledChecked ? "Checked" : "Unchecked"))
                        </label>
                    </div>
                </div>

                <CodeBlock Source="Primitives/Checkbox/controlled.txt" />
            </div>
        </section>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">Indeterminate State</h2>
                <p class="text-muted-foreground">
                    Useful for "select all" scenarios when only some items are selected.
                </p>
            </div>

            <div class="rounded-lg border bg-card p-6 max-w-md">
                <div class="space-y-3">
                    <div class="flex items-center gap-3">
                        <BlazorBlueprint.Primitives.Checkbox.BbCheckbox Checked="@allChecked" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center"
                                           Indeterminate="@indeterminate"
                                           CheckedChanged="@HandleParentChanged"
                                           Id="parent">
                            <BlazorBlueprint.Primitives.Checkbox.BbCheckboxIndicator />
                        </BlazorBlueprint.Primitives.Checkbox.BbCheckbox>
                        <label for="parent" class="font-medium">Select All</label>
                    </div>
                    <div class="ml-6 space-y-2">
                        <div class="flex items-center gap-3">
                            <BlazorBlueprint.Primitives.Checkbox.BbCheckbox Checked="@child1" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center" CheckedChanged="@(v => { child1 = v; HandleChildChanged(); })" Id="child1">
                                <BlazorBlueprint.Primitives.Checkbox.BbCheckboxIndicator />
                            </BlazorBlueprint.Primitives.Checkbox.BbCheckbox>
                            <label for="child1">Option 1</label>
                        </div>
                        <div class="flex items-center gap-3">
                            <BlazorBlueprint.Primitives.Checkbox.BbCheckbox Checked="@child2" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center" CheckedChanged="@(v => { child2 = v; HandleChildChanged(); })" Id="child2">
                                <BlazorBlueprint.Primitives.Checkbox.BbCheckboxIndicator />
                            </BlazorBlueprint.Primitives.Checkbox.BbCheckbox>
                            <label for="child2">Option 2</label>
                        </div>
                        <div class="flex items-center gap-3">
                            <BlazorBlueprint.Primitives.Checkbox.BbCheckbox Checked="@child3" class="h-5 w-5 border rounded cursor-pointer flex items-center justify-center" CheckedChanged="@(v => { child3 = v; HandleChildChanged(); })" Id="child3">
                                <BlazorBlueprint.Primitives.Checkbox.BbCheckboxIndicator />
                            </BlazorBlueprint.Primitives.Checkbox.BbCheckbox>
                            <label for="child3">Option 3</label>
                        </div>
                    </div>
                </div>
            </div>

            <CodeBlock Source="Primitives/Checkbox/indeterminate.txt" />
        </section>

        <AccessibilityList>
            <AriaAttributes>
                <AccessibilityItem>
                    <code class="text-xs bg-muted px-1 py-0.5 rounded">role="checkbox"</code> for screen readers
                </AccessibilityItem>
                <AccessibilityItem>
                    <code class="text-xs bg-muted px-1 py-0.5 rounded">aria-checked</code> indicates checked state (true/false/mixed)
                </AccessibilityItem>
                <AccessibilityItem>
                    <code class="text-xs bg-muted px-1 py-0.5 rounded">data-state</code> attribute for CSS styling (checked|unchecked|indeterminate)
                </AccessibilityItem>
                <AccessibilityItem>
                    <code class="text-xs bg-muted px-1 py-0.5 rounded">disabled</code> attribute for disabled state
                </AccessibilityItem>
                <AccessibilityItem>
                    Focus management with visible focus indicators
                </AccessibilityItem>
            </AriaAttributes>
            <KeyboardNavigation>
                <KeyboardShortcutItem Description="Navigate to checkbox">
                    <BbKbd>Tab</BbKbd>
                </KeyboardShortcutItem>
                <KeyboardShortcutItem Description="Toggle checkbox">
                    <BbKbd>Space</BbKbd>
                </KeyboardShortcutItem>
            </KeyboardNavigation>
        </AccessibilityList>

        <section class="space-y-4">
            <div class="space-y-2">
                <h2 class="text-2xl font-semibold">API Reference</h2>
                <p class="text-muted-foreground">
                    Component properties and parameters.
                </p>
            </div>

            <div class="space-y-4">
                <ApiReference ComponentName="Checkbox">
                    <ApiParameter Name="Checked" Type="bool" Default="false">
                        Controls whether the checkbox is checked. Supports two-way binding with <code>@@bind-Checked</code>.
                    </ApiParameter>
                    <ApiParameter Name="CheckedChanged" Type="EventCallback&lt;bool&gt;">
                        Callback invoked when the checked state changes.
                    </ApiParameter>
                    <ApiParameter Name="Indeterminate" Type="bool" Default="false">
                        Sets the checkbox to indeterminate state (for "select all" scenarios). Sets <code>aria-checked="mixed"</code>.
                    </ApiParameter>
                    <ApiParameter Name="IndeterminateChanged" Type="EventCallback&lt;bool&gt;">
                        Callback invoked when the indeterminate state changes.
                    </ApiParameter>
                    <ApiParameter Name="Disabled" Type="bool" Default="false">
                        Prevents toggling when true. Sets <code>aria-disabled</code>.
                    </ApiParameter>
                    <ApiParameter Name="Id" Type="string?">
                        Unique identifier for the checkbox element. Used for label association.
                    </ApiParameter>
                    <ApiParameter Name="AriaLabel" Type="string?">
                        Accessible label for screen readers when no visible label is associated.
                    </ApiParameter>
                    <ApiParameter Name="ChildContent" Type="RenderFragment?">
                        Content rendered inside the checkbox (typically a <code>CheckboxIndicator</code>).
                    </ApiParameter>
                    <ApiParameter Name="AdditionalAttributes" Type="Dictionary&lt;string, object&gt;?">
                        Additional HTML attributes applied to the root button element (e.g. <code>class</code>, <code>style</code>).
                    </ApiParameter>
                </ApiReference>

                <ApiReference ComponentName="CheckboxIndicator">
                    <ApiParameter Name="Size" Type="int" Default="14">
                        Size of the default SVG icons in pixels.
                    </ApiParameter>
                    <ApiParameter Name="StrokeWidth" Type="int" Default="3">
                        Stroke width of the default SVG icons.
                    </ApiParameter>
                    <ApiParameter Name="ChildContent" Type="RenderFragment?">
                        Custom content to render instead of default icons.
                    </ApiParameter>
                    <ApiParameter Name="AdditionalAttributes" Type="Dictionary&lt;string, object&gt;?">
                        Additional HTML attributes applied to the SVG icon elements.
                    </ApiParameter>
                </ApiReference>
            </div>
        </section>
    </div>
</div>

@code {
    private bool basicChecked = false;
    private bool controlledChecked = false;

    // Indeterminate state demo
    private bool child1 = true;
    private bool child2 = false;
    private bool child3 = true;
    private bool allChecked = false;
    private bool indeterminate = true;

    protected override void OnInitialized()
    {
        UpdateParentState();
    }

    private void HandleChildChanged()
    {
        UpdateParentState();
    }

    private void HandleParentChanged(bool value)
    {
        allChecked = value;
        indeterminate = false;
        child1 = value;
        child2 = value;
        child3 = value;
    }

    private void UpdateParentState()
    {
        var checkedCount = (child1 ? 1 : 0) + (child2 ? 1 : 0) + (child3 ? 1 : 0);

        if (checkedCount == 0)
        {
            allChecked = false;
            indeterminate = false;
        }
        else if (checkedCount == 3)
        {
            allChecked = true;
            indeterminate = false;
        }
        else
        {
            allChecked = false;
            indeterminate = true;
        }
    }
}
