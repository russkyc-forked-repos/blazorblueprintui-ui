@namespace BlazorBlueprint.Components
@implements IDisposable

<div class="@CssClass"
     style="@(_isVisible ? null : "display: none")"
     role="separator"
     aria-orientation="horizontal">
</div>

@code {
    [CascadingParameter]
    public CommandContext? Context { get; set; }

    /// <summary>
    /// Gets or sets additional CSS classes to apply to the separator.
    /// </summary>
    [Parameter]
    public string? Class { get; set; }

    private bool _isVisible = true;

    /// <summary>
    /// Gets the computed CSS classes for the separator.
    /// </summary>
    private string CssClass => ClassNames.cn(
        "-mx-1 h-px bg-border",
        Class
    );

    protected override void OnInitialized()
    {
        if (Context != null)
        {
            Context.OnStateChanged += HandleContextStateChanged;
        }
    }

    private void HandleContextStateChanged()
    {
        if (Context == null) return;

        // Hide separator when there are no visible items (during filtering)
        _isVisible = Context.HasVisibleItems();
        StateHasChanged();
    }

    public void Dispose()
    {
        if (Context != null)
        {
            Context.OnStateChanged -= HandleContextStateChanged;
        }
    }
}
