@typeparam TValue
@namespace BlazorBlueprint.Components

@* Styled SelectTrigger wrapper around SelectTrigger primitive *@
<BlazorBlueprint.Primitives.Select.BbSelectTrigger TValue="TValue"
                                               class="@CssClass"
                                               @attributes="AdditionalAttributes">
    @ChildContent
    <svg class="ms-2 h-4 w-4 opacity-50" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="6 9 12 15 18 9"></polyline>
    </svg>
</BlazorBlueprint.Primitives.Select.BbSelectTrigger>

@code {
    /// <summary>
    /// Cascading parameter to infer TValue from parent Select context.
    /// </summary>
    [CascadingParameter]
    private BlazorBlueprint.Primitives.Select.SelectContext<TValue>? Context { get; set; }

    /// <summary>
    /// Gets or sets additional CSS classes to apply to the trigger button.
    /// </summary>
    [Parameter]
    public string? Class { get; set; }

    /// <summary>
    /// Gets or sets CSS classes applied when the dropdown is open.
    /// Default is <c>"bg-accent text-accent-foreground"</c>.
    /// Set to <c>null</c> or empty to disable the active style.
    /// </summary>
    [Parameter]
    public string? ActiveClass { get; set; } = "bg-accent text-accent-foreground";

    /// <summary>
    /// Gets or sets the content to be rendered inside the trigger button.
    /// </summary>
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    /// <summary>
    /// Gets or sets additional attributes to be applied to the trigger button.
    /// </summary>
    [Parameter(CaptureUnmatchedValues = true)]
    public Dictionary<string, object>? AdditionalAttributes { get; set; }

    private bool IsOpen => Context?.IsOpen ?? false;

    /// <summary>
    /// Gets the computed CSS classes for the trigger button.
    /// </summary>
    private string CssClass => ClassNames.cn(
        "flex h-10 w-full items-center justify-between rounded-md border border-input",
        "bg-background px-3 py-2 text-sm",
        "placeholder:text-muted-foreground",
        "hover:bg-accent hover:text-accent-foreground",
        "focus:outline-none",
        "disabled:cursor-not-allowed disabled:opacity-50",
        IsOpen ? ActiveClass : null,
        Class
    );
}
