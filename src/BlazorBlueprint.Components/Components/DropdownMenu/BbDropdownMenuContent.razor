@namespace BlazorBlueprint.Components

@* Styled DropdownMenuContent - wrapper with shadcn Tailwind classes *@
<BlazorBlueprint.Primitives.DropdownMenu.BbDropdownMenuContent class="@CssClass"
                                                            style="@Style"
                                                            CloseOnEscape="@CloseOnEscape"
                                                            CloseOnClickOutside="@CloseOnClickOutside"
                                                            Side="@Side"
                                                            Align="@Align"
                                                            Offset="@Offset"
                                                            OnEscapeKeyDown="@OnEscapeKeyDown"
                                                            OnClickOutside="@OnClickOutside"
                                                            Loop="@Loop"
                                                            Strategy="@Strategy"
                                                            MatchTriggerWidth="@MatchTriggerWidth"
                                                            ZIndex="@ZIndex">
    <div class="p-1">
        @ChildContent
    </div>
</BlazorBlueprint.Primitives.DropdownMenu.BbDropdownMenuContent>

@code {
    /// <summary>
    /// The content to render inside the dropdown menu.
    /// </summary>
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    /// <summary>
    /// Additional CSS classes to apply to the content container.
    /// </summary>
    [Parameter]
    public string? Class { get; set; }

    /// <summary>
    /// Whether pressing Escape should close the dropdown menu.
    /// </summary>
    [Parameter]
    public bool CloseOnEscape { get; set; } = true;

    /// <summary>
    /// Whether clicking outside should close the dropdown menu.
    /// </summary>
    [Parameter]
    public bool CloseOnClickOutside { get; set; } = true;

    /// <summary>
    /// Preferred side for positioning.
    /// </summary>
    [Parameter]
    public PopoverSide Side { get; set; } = PopoverSide.Bottom;

    /// <summary>
    /// Alignment relative to trigger.
    /// </summary>
    [Parameter]
    public PopoverAlign Align { get; set; } = PopoverAlign.Start;

    /// <summary>
    /// Offset distance from the trigger in pixels.
    /// </summary>
    [Parameter]
    public int Offset { get; set; } = 4;

    /// <summary>
    /// Event callback invoked when Escape key is pressed.
    /// </summary>
    [Parameter]
    public EventCallback<KeyboardEventArgs> OnEscapeKeyDown { get; set; }

    /// <summary>
    /// Event callback invoked when clicking outside.
    /// </summary>
    [Parameter]
    public EventCallback OnClickOutside { get; set; }

    /// <summary>
    /// Whether to enable keyboard loop navigation.
    /// </summary>
    [Parameter]
    public bool Loop { get; set; } = true;

    /// <summary>
    /// Positioning strategy: "absolute" or "fixed".
    /// Use "fixed" when dropdown needs to escape stacking contexts (e.g., in sidebars).
    /// Default is "absolute".
    /// </summary>
    [Parameter]
    public PositioningStrategy Strategy { get; set; } = PositioningStrategy.Absolute;

    /// <summary>
    /// Whether to match the trigger element's width.
    /// Default is false.
    /// </summary>
    [Parameter]
    public bool MatchTriggerWidth { get; set; } = false;

    /// <summary>
    /// Z-index for the dropdown content.
    /// Default is 50.
    /// </summary>
    [Parameter]
    public int ZIndex { get; set; } = 50;

    /// <summary>
    /// Inline styles to apply to the dropdown content.
    /// </summary>
    [Parameter]
    public string? Style { get; set; }

    private string CssClass => ClassNames.cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover",
        "text-popover-foreground shadow-md",
        "data-[state=open]:animate-in data-[state=closed]:animate-out",
        "data-[state=open]:data-[side=top]:animate-content-slide-in-from-bottom",
        "data-[state=open]:data-[side=bottom]:animate-content-slide-in-from-top",
        "data-[state=open]:data-[side=left]:animate-content-slide-in-from-right",
        "data-[state=open]:data-[side=right]:animate-content-slide-in-from-left",
        "data-[state=closed]:data-[side=top]:animate-content-slide-out-to-bottom",
        "data-[state=closed]:data-[side=bottom]:animate-content-slide-out-to-top",
        "data-[state=closed]:data-[side=left]:animate-content-slide-out-to-right",
        "data-[state=closed]:data-[side=right]:animate-content-slide-out-to-left",
        Class
    );
}
