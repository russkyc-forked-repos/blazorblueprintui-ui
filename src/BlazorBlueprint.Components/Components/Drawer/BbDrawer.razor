@namespace BlazorBlueprint.Components

@* Drawer - A mobile-friendly slide panel built on Sheet primitive *@
<CascadingValue Value="this" IsFixed="true">
    @ChildContent
</CascadingValue>

@code {
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    [Parameter]
    public bool? Open { get; set; }

    [Parameter]
    public EventCallback<bool> OpenChanged { get; set; }

    [Parameter]
    public bool DefaultOpen { get; set; }

    [Parameter]
    public DrawerDirection Direction { get; set; } = DrawerDirection.Bottom;

    internal bool IsControlled => Open.HasValue;
    internal bool IsOpen => Open ?? _internalOpen;
    private bool _internalOpen;

    internal async Task SetOpen(bool open)
    {
        if (IsControlled)
        {
            await OpenChanged.InvokeAsync(open);
        }
        else
        {
            _internalOpen = open;
            StateHasChanged();
        }
    }

    protected override void OnInitialized()
    {
        _internalOpen = DefaultOpen;
    }
}
