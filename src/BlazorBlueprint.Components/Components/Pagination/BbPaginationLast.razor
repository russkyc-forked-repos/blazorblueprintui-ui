@namespace BlazorBlueprint.Components
@using BlazorBlueprint.Icons.Lucide.Components

<BbPaginationLink Size="PaginationLinkSize.Icon"
                Class="@CssClass"
                Disabled="@IsDisabled"
                OnClick="HandleClick">
    <LucideIcon Name="chevrons-right" Class="h-4 w-4" />
    <span class="sr-only">Go to last page</span>
</BbPaginationLink>

@code {
    [CascadingParameter]
    private PaginationContext? Context { get; set; }

    [Parameter]
    public string? Class { get; set; }

    /// <summary>
    /// Explicitly disable the button. When null, automatically determined from pagination state.
    /// </summary>
    [Parameter]
    public bool? Disabled { get; set; }

    /// <summary>
    /// Custom click handler. When using pagination state, navigation is automatic.
    /// </summary>
    [Parameter]
    public EventCallback OnClick { get; set; }

    private bool IsDisabled => Disabled ?? !(Context?.State?.CanGoNext ?? true);

    private async Task HandleClick()
    {
        if (Context?.State != null)
        {
            Context.State.LastPage();
            if (Context.OnPageChanged != null)
                await Context.OnPageChanged(Context.State.CurrentPage);
        }

        if (OnClick.HasDelegate)
            await OnClick.InvokeAsync();
    }

    private string CssClass => ClassNames.cn(
        "h-8 w-8",
        Class
    );
}
